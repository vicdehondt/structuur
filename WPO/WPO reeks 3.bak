(define (1- x) (- x 1))

(define (1+ x) (+ 1 x))

(define (rec-add a b)
  (if (= b 0)
      a
      (1+ (rec-add a (1- b)))))

(define (iter-add a b)
  (if (zero? b)
      a
      (iter-add (1+ a) (1- b))))

(define (rec-multiply a b)
  (if (zero? b)
      0
      (+ a (rec-multiply a (1- b)))))

(define (iter-multiply a b)
  (if (= b 1)
      (* a b)
      (iter-multiply (+ (* a (1- b)) a) (1- b))))

(define (double a)
  (+ a a))

(define (halve a)
  (/ a 2))

(define (rec-fast-multiply a b)
  (cond
    ((zero? b) 0)
    ((even? b) (+ (* (halve b) a)
                  (rec-fast-multiply (* a (halve b)) (halve b))))
    ((= b 1) )
    (else (display "test"))))


(define (calc-e n)
  (define (iter counter result prev-fac)
    (if (= counter n)
        result
        (iter (+ counter 1) (+ result (/ 1 (* counter prev-fac))) (* counter prev-fac))))
  (iter 1 1 1))

(define (my-odd? x)
  (if (zero? x)
      #f
      (my-even? (- x 1))))

(define (my-even? x)
  (if (zero? x)
      #t
      (my-odd? (- x 1))))

(define (weird x)
  (cond ((= x 1) 1)
        ((even? x) (weird (/ x 2)))
        (else (weird (+ (* 3 x) 1)))))

(define (depth-weird x)
  (define (depth x counter)
    (cond ((= x 1) counter)
          ((even? x) (depth (/ x 2) (+ counter 1)))
          (else (depth (+ (* 3 x) 1) (+ counter 1)))))
  (depth x 0))

(define (display-as-binary n)
  (if (<= n 1)
      (if (even? n)
          (display "0")
          (display "1"))
      (if (even? n)
          (begin (display-as-binary (quotient n 2))
             (display "0"))
          (begin (display-as-binary (quotient n 2))
             (display "1")))))

(define (display-n x n)
  (if (zero? n)
      (display "")
      (begin
        (display x)
        (display-n x (- n 1)))))

(define (parasol n)
  (define (1-star x)
    (begin
      (display-n " " x)
      (display-n "*" 1)
      (newline)))
  (define (blank-width x)
    (/ (- (* 2 n) 2) 2))
  (define (counter count star)
    (if (= count (+ n 1))
      (begin
        (1-star (blank-width n))
        (1-star (blank-width n))
        (1-star (blank-width n)))
      (begin
        (display-n " " (- (blank-width n) (- count 1)))
        (display-n "*" star)
        (display "*")
        (display-n "*" star)
        (newline)
        (counter (+ count 1) (+ star 1)))))
  (counter 1 0))